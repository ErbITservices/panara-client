{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Mihir k\\\\first-react\\\\panara\\\\react\\\\src\\\\components\\\\Product.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\n//import { products } from '../DummyData'\nimport ProductItem from './ProductItem';\nimport styled from 'styled-components';\nimport axios from \"axios\";\nimport { mobile } from '../Responsive';\nimport { publicRequest } from '../axiosReqMethods';\nimport { setError } from '../redux/errorRedux';\nimport { useDispatch } from 'react-redux';\nimport ProductNotFound from './ProductNotFound';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Container = styled.div`\n    display: flex;\n    flex-direction: column;\n    align-items: center;  \n    margin-bottom: 30px;\n`;\n_c = Container;\nconst LoadMore = styled.button`\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  border: 1px solid teal;\n  background-color: white;\n  box-shadow: 0 5px 15px rgba(0, 128, 128, 0.1);\n  transition: all 0.3s ease-in-out;\n  :hover {\n      background-color: teal;\n      color: white;\n      box-shadow: 0 5px 15px rgba(0, 128, 128, 0.3);\n  }\n`;\n_c2 = LoadMore;\nconst Wrapper = styled.div`\n  padding: 20px;\n  display: flex;\n  gap: 0.5rem;\n  background: rgba(255, 255, 255, 0.2);\n  box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);\n  backdrop-filter: blur(9.5px);\n  -webkit-backdrop-filter: blur(9.5px);\n  border-radius: 10px;\n  border: 1px solid rgba(255, 255, 255, 0.18);\n  flex-wrap: wrap;\n  justify-content: space-evenly;\n  ${mobile({\n  padding: \"0px\",\n  gap: \"0\"\n})}\n`;\n_c3 = Wrapper;\nfunction Product(props) {\n  _s();\n  const {\n    sort,\n    cat,\n    filter\n  } = props;\n  const [products, setProducts] = useState([]);\n  const [page, setPage] = useState(1);\n  const {\n    color,\n    size\n  } = filter || {};\n  const [prevFilters, setPrevFilters] = useState({\n    color: null,\n    size: null,\n    sort: null\n  });\n  const dispatch = useDispatch();\n  useEffect(() => {\n    setPrevFilters({\n      sort,\n      color,\n      size\n    });\n    setPage(1);\n  }, [sort, color, size]);\n  useEffect(() => {\n    const axiosCancelToken = axios.CancelToken.source();\n    let url = `/api/products/allinfo?page=${page}`;\n    if (cat) url += `&category=${cat}`;\n    if (color) url += `&color=${color}`;\n    if (size) url += `&size=${size}`;\n    if (sort) url += `&sort=${sort}`;\n    const getProducts = async () => {\n      try {\n        const res = await publicRequest.get(url, {\n          cancelToken: axiosCancelToken.token\n        });\n        const filtersChanged = JSON.stringify(prevFilters) !== JSON.stringify({\n          sort,\n          color,\n          size\n        }); //checking if a filtering is changed\n        if (filtersChanged) {\n          //if changd then set new product\n          setProducts(res.data);\n        } else {\n          //else append new product with prev product\n          setProducts(p => [...p, ...res.data]);\n        }\n      } catch (error) {\n        if (error.response.status === 404) return dispatch(setError(error.response.data.message));\n        if (axios.isCancel(error)) return setProducts([]); //req canceled by user\n\n        dispatch(setError(error.response.data.message));\n      }\n    };\n    getProducts();\n    return () => {\n      axiosCancelToken.cancel();\n    };\n  }, [cat, page, color, size, sort]);\n\n  //filter products logic\n  useEffect(() => {\n    filter && filter.color === \"Color\" && delete filter.color;\n    filter && filter.size === \"Size\" && delete filter.size;\n  }, [filter]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Container, {\n      className: \"container\",\n      children: !products.length ? /*#__PURE__*/_jsxDEV(ProductNotFound, {\n        title: \"Opps! No product Found\",\n        desc: \"Your filter did not match any product\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 30\n      }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Wrapper, {\n          children: products.map(Data => {\n            return /*#__PURE__*/_jsxDEV(ProductItem, {\n              data: Data\n            }, Data._id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 114,\n              columnNumber: 47\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(LoadMore, {\n          onClick: () => setPage(p => p + 1),\n          children: \"Load More\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n}\n_s(Product, \"MIh6IAm/DZlOZv0IoqMYfnApx8U=\", false, function () {\n  return [useDispatch];\n});\n_c4 = Product;\nexport default Product;\nvar _c, _c2, _c3, _c4;\n$RefreshReg$(_c, \"Container\");\n$RefreshReg$(_c2, \"LoadMore\");\n$RefreshReg$(_c3, \"Wrapper\");\n$RefreshReg$(_c4, \"Product\");","map":{"version":3,"names":["React","useState","useEffect","ProductItem","styled","axios","mobile","publicRequest","setError","useDispatch","ProductNotFound","jsxDEV","_jsxDEV","Fragment","_Fragment","Container","div","_c","LoadMore","button","_c2","Wrapper","padding","gap","_c3","Product","props","_s","sort","cat","filter","products","setProducts","page","setPage","color","size","prevFilters","setPrevFilters","dispatch","axiosCancelToken","CancelToken","source","url","getProducts","res","get","cancelToken","token","filtersChanged","JSON","stringify","data","p","error","response","status","message","isCancel","cancel","children","className","length","title","desc","fileName","_jsxFileName","lineNumber","columnNumber","map","Data","_id","onClick","_c4","$RefreshReg$"],"sources":["C:/Users/Mihir k/first-react/panara/react/src/components/Product.js"],"sourcesContent":["import React, { useState, useEffect } from 'react'\r\n//import { products } from '../DummyData'\r\nimport ProductItem from './ProductItem'\r\nimport styled from 'styled-components'\r\nimport axios from \"axios\"\r\nimport { mobile } from '../Responsive'\r\nimport { publicRequest } from '../axiosReqMethods'\r\nimport { setError } from '../redux/errorRedux'\r\nimport { useDispatch } from 'react-redux'\r\nimport ProductNotFound from './ProductNotFound'\r\n\r\n\r\n\r\nconst Container = styled.div`\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;  \r\n    margin-bottom: 30px;\r\n`\r\nconst LoadMore = styled.button`\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 10px;\r\n  border: 1px solid teal;\r\n  background-color: white;\r\n  box-shadow: 0 5px 15px rgba(0, 128, 128, 0.1);\r\n  transition: all 0.3s ease-in-out;\r\n  :hover {\r\n      background-color: teal;\r\n      color: white;\r\n      box-shadow: 0 5px 15px rgba(0, 128, 128, 0.3);\r\n  }\r\n`\r\nconst Wrapper = styled.div`\r\n  padding: 20px;\r\n  display: flex;\r\n  gap: 0.5rem;\r\n  background: rgba(255, 255, 255, 0.2);\r\n  box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);\r\n  backdrop-filter: blur(9.5px);\r\n  -webkit-backdrop-filter: blur(9.5px);\r\n  border-radius: 10px;\r\n  border: 1px solid rgba(255, 255, 255, 0.18);\r\n  flex-wrap: wrap;\r\n  justify-content: space-evenly;\r\n  ${mobile({\r\n    padding: \"0px\",\r\n    gap: \"0\",\r\n  })}\r\n`;\r\n\r\n\r\nfunction Product(props) {\r\n  const {sort, cat, filter} = props;\r\n  const [products, setProducts] =useState([])\r\n  const [page, setPage] = useState(1)\r\n  const {color, size} = filter || {}\r\n  const [prevFilters, setPrevFilters] = useState({color: null, size: null, sort: null});\r\n  const dispatch = useDispatch()\r\n\r\n  useEffect(() => {\r\n      setPrevFilters({sort, color, size});\r\n      setPage(1)\r\n  }, [sort, color, size]);\r\n\r\n\r\n  useEffect(() => {\r\n    const axiosCancelToken = axios.CancelToken.source()   \r\n    let url = `/api/products/allinfo?page=${page}`\r\n    if (cat) url += `&category=${cat}`\r\n    if (color) url += `&color=${color}`\r\n    if (size) url += `&size=${size}`\r\n    if (sort) url += `&sort=${sort}`\r\n\r\n    const getProducts = async () => { \r\n      try {\r\n        const res = await publicRequest.get( url ,{cancelToken: axiosCancelToken.token}) \r\n        const filtersChanged = JSON.stringify(prevFilters) !== JSON.stringify({sort, color, size}) //checking if a filtering is changed\r\n        if (filtersChanged) { //if changd then set new product\r\n            setProducts(res.data);\r\n        } else { //else append new product with prev product\r\n            setProducts(p => [...p, ...res.data]);\r\n        }\r\n      } catch (error) {\r\n        if(error.response.status === 404) return dispatch(setError(error.response.data.message))\r\n        if(axios.isCancel(error)) return setProducts([]) //req canceled by user\r\n        \r\n        dispatch(setError(error.response.data.message))\r\n    \r\n      }\r\n    } \r\n    getProducts();\r\n\r\n    return () => {\r\n      axiosCancelToken.cancel();\r\n    }\r\n  }, [cat, page, color, size,sort])\r\n\r\n\r\n  \r\n  //filter products logic\r\n    useEffect(()=> {\r\n      filter && filter.color === \"Color\" && delete filter.color;\r\n      filter && filter.size === \"Size\" && delete filter.size;\r\n    }, [filter])\r\n  \r\n  return (\r\n    <>\r\n      <Container className='container'>\r\n        { !products.length ? <ProductNotFound title=\"Opps! No product Found\" desc=\"Your filter did not match any product\"/> \r\n        :\r\n          <>\r\n            <Wrapper>\r\n              {products.map((Data)=> { return <ProductItem data={Data} key={Data._id} />})}       \r\n            </Wrapper> \r\n            <LoadMore onClick={() => setPage(p => p+1)}>Load More</LoadMore>\r\n          </>\r\n        }\r\n      </Container>\r\n      \r\n    </>\r\n  )\r\n}\r\n\r\nexport default Product"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}