{"ast":null,"code":"import React,{useState,useEffect}from'react';//import { products } from '../DummyData'\nimport ProductItem from'./ProductItem';import styled from'styled-components';import axios from\"axios\";import{mobile}from'../Responsive';import{publicRequest}from'../axiosReqMethods';import{setError}from'../redux/errorRedux';import{useDispatch}from'react-redux';import ProductNotFound from'./ProductNotFound';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const Container=styled.div`\n    display: flex;\n    flex-direction: column;\n    align-items: center;  \n    margin-bottom: 30px;\n`;const LoadMore=styled.button`\n  display: flex;\n  align-items: center;\n  padding: 10px;\n  border: 1px solid teal;\n  background-color: white;\n  box-shadow: 0 5px 15px rgba(0, 128, 128, 0.1);\n  transition: all 0.3s ease-in-out;\n  :hover {\n      background-color: teal;\n      color: white;\n      box-shadow: 0 5px 15px rgba(0, 128, 128, 0.3);\n  }\n`;const Wrapper=styled.div`\n  padding: 20px;\n  display: flex;\n  gap: 0.5rem;\n  background: rgba(255, 255, 255, 0.2);\n  box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);\n  backdrop-filter: blur(9.5px);\n  -webkit-backdrop-filter: blur(9.5px);\n  border-radius: 10px;\n  border: 1px solid rgba(255, 255, 255, 0.18);\n  flex-wrap: wrap;\n  justify-content: space-evenly;\n  ${mobile({padding:\"0px\",gap:\"0\"})}\n`;function Product(props){const{sort,cat,filter}=props;const[products,setProducts]=useState([]);const[page,setPage]=useState(1);const{color,size}=filter||{};const[prevFilters,setPrevFilters]=useState({color:null,size:null,sort:null});const dispatch=useDispatch();useEffect(()=>{setPrevFilters({sort,color,size});setPage(1);},[sort,color,size]);useEffect(()=>{const axiosCancelToken=axios.CancelToken.source();let url=`/api/products/allinfo?page=${page}`;if(cat)url+=`&category=${cat}`;if(color)url+=`&color=${color}`;if(size)url+=`&size=${size}`;if(sort)url+=`&sort=${sort}`;const getProducts=async()=>{try{const res=await publicRequest.get(url,{cancelToken:axiosCancelToken.token});const filtersChanged=JSON.stringify(prevFilters)!==JSON.stringify({sort,color,size});//checking if a filtering is changed\nif(filtersChanged){//if changd then set new product\nsetProducts(res.data);}else{//else append new product with prev product\nsetProducts(p=>[...p,...res.data]);}}catch(error){if(error.response.status===404)return dispatch(setError(error.response.data.message));if(axios.isCancel(error))return setProducts([]);//req canceled by user\ndispatch(setError(error.response.data.message));}};getProducts();return()=>{axiosCancelToken.cancel();};},[cat,page,color,size,sort]);//filter products logic\nuseEffect(()=>{filter&&filter.color===\"Color\"&&delete filter.color;filter&&filter.size===\"Size\"&&delete filter.size;},[filter]);return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Container,{className:\"container\",children:!products.length?/*#__PURE__*/_jsx(ProductNotFound,{title:\"Opps! No product Found\",desc:\"Your filter did not match any product\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Wrapper,{children:products.map(Data=>{return/*#__PURE__*/_jsx(ProductItem,{data:Data},Data._id);})}),/*#__PURE__*/_jsx(LoadMore,{onClick:()=>setPage(p=>p+1),children:\"Load More\"})]})})});}export default Product;","map":{"version":3,"names":["React","useState","useEffect","ProductItem","styled","axios","mobile","publicRequest","setError","useDispatch","ProductNotFound","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Container","div","LoadMore","button","Wrapper","padding","gap","Product","props","sort","cat","filter","products","setProducts","page","setPage","color","size","prevFilters","setPrevFilters","dispatch","axiosCancelToken","CancelToken","source","url","getProducts","res","get","cancelToken","token","filtersChanged","JSON","stringify","data","p","error","response","status","message","isCancel","cancel","children","className","length","title","desc","map","Data","_id","onClick"],"sources":["M:/first-react/panara/react/src/components/Product.js"],"sourcesContent":["import React, { useState, useEffect } from 'react'\r\n//import { products } from '../DummyData'\r\nimport ProductItem from './ProductItem'\r\nimport styled from 'styled-components'\r\nimport axios from \"axios\"\r\nimport { mobile } from '../Responsive'\r\nimport { publicRequest } from '../axiosReqMethods'\r\nimport { setError } from '../redux/errorRedux'\r\nimport { useDispatch } from 'react-redux'\r\nimport ProductNotFound from './ProductNotFound'\r\n\r\n\r\n\r\nconst Container = styled.div`\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;  \r\n    margin-bottom: 30px;\r\n`\r\nconst LoadMore = styled.button`\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 10px;\r\n  border: 1px solid teal;\r\n  background-color: white;\r\n  box-shadow: 0 5px 15px rgba(0, 128, 128, 0.1);\r\n  transition: all 0.3s ease-in-out;\r\n  :hover {\r\n      background-color: teal;\r\n      color: white;\r\n      box-shadow: 0 5px 15px rgba(0, 128, 128, 0.3);\r\n  }\r\n`\r\nconst Wrapper = styled.div`\r\n  padding: 20px;\r\n  display: flex;\r\n  gap: 0.5rem;\r\n  background: rgba(255, 255, 255, 0.2);\r\n  box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);\r\n  backdrop-filter: blur(9.5px);\r\n  -webkit-backdrop-filter: blur(9.5px);\r\n  border-radius: 10px;\r\n  border: 1px solid rgba(255, 255, 255, 0.18);\r\n  flex-wrap: wrap;\r\n  justify-content: space-evenly;\r\n  ${mobile({\r\n    padding: \"0px\",\r\n    gap: \"0\",\r\n  })}\r\n`;\r\n\r\n\r\nfunction Product(props) {\r\n  const {sort, cat, filter} = props;\r\n  const [products, setProducts] =useState([])\r\n  const [page, setPage] = useState(1)\r\n  const {color, size} = filter || {}\r\n  const [prevFilters, setPrevFilters] = useState({color: null, size: null, sort: null});\r\n  const dispatch = useDispatch()\r\n\r\n  useEffect(() => {\r\n      setPrevFilters({sort, color, size});\r\n      setPage(1)\r\n  }, [sort, color, size]);\r\n\r\n\r\n  useEffect(() => {\r\n    const axiosCancelToken = axios.CancelToken.source()   \r\n    let url = `/api/products/allinfo?page=${page}`\r\n    if (cat) url += `&category=${cat}`\r\n    if (color) url += `&color=${color}`\r\n    if (size) url += `&size=${size}`\r\n    if (sort) url += `&sort=${sort}`\r\n\r\n    const getProducts = async () => { \r\n      try {\r\n        const res = await publicRequest.get( url ,{cancelToken: axiosCancelToken.token}) \r\n        const filtersChanged = JSON.stringify(prevFilters) !== JSON.stringify({sort, color, size}) //checking if a filtering is changed\r\n        if (filtersChanged) { //if changd then set new product\r\n            setProducts(res.data);\r\n        } else { //else append new product with prev product\r\n            setProducts(p => [...p, ...res.data]);\r\n        }\r\n      } catch (error) {\r\n        if(error.response.status === 404) return dispatch(setError(error.response.data.message))\r\n        if(axios.isCancel(error)) return setProducts([]) //req canceled by user\r\n        \r\n        dispatch(setError(error.response.data.message))\r\n    \r\n      }\r\n    } \r\n    getProducts();\r\n\r\n    return () => {\r\n      axiosCancelToken.cancel();\r\n    }\r\n  }, [cat, page, color, size,sort])\r\n\r\n\r\n  \r\n  //filter products logic\r\n    useEffect(()=> {\r\n      filter && filter.color === \"Color\" && delete filter.color;\r\n      filter && filter.size === \"Size\" && delete filter.size;\r\n    }, [filter])\r\n  \r\n  return (\r\n    <>\r\n      <Container className='container'>\r\n        { !products.length ? <ProductNotFound title=\"Opps! No product Found\" desc=\"Your filter did not match any product\"/> \r\n        :\r\n          <>\r\n            <Wrapper>\r\n              {products.map((Data)=> { return <ProductItem data={Data} key={Data._id} />})}       \r\n            </Wrapper> \r\n            <LoadMore onClick={() => setPage(p => p+1)}>Load More</LoadMore>\r\n          </>\r\n        }\r\n      </Container>\r\n      \r\n    </>\r\n  )\r\n}\r\n\r\nexport default Product"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}